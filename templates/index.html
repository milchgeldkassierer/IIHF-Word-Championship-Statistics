{% extends 'base.html' %}

{% block title %}Startseite - IIHF Tabellenrechner{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-6">
        <h2>Turnier anlegen / Jahr auswählen</h2>
        <form method="POST" enctype="multipart/form-data" class="mb-4">
            <div class="form-group">
                <label for="tournament_name">Name des Turniers</label>
                <input type="text" class="form-control" id="tournament_name" name="tournament_name" placeholder="z.B. WM 2025 oder Virtual Cup" required>
            </div>
            <div class="form-group">
                <label for="year">Jahr (Spielplan wird automatisch geladen)</label>
                <select class="form-control" id="year" name="year" required>
                    <option value="" disabled selected>Bitte Jahr auswählen</option>
                    {% for year_option in available_fixture_years %}
                    <option value="{{ year_option }}">{{ year_option }}</option>
                    {% endfor %}
                    {% if not available_fixture_years %}
                    <option value="" disabled>Keine Spielpläne gefunden. Bitte .json Datei in 'fixtures' ablegen.</option>
                    {% endif %}
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Turnier anlegen / Aktualisieren</button>
        </form>
    </div>

    <div class="col-md-6">
        <h2>Vorhandene Turniere</h2>
        {% if all_years %}
            <ul class="list-group">
                {% for y in all_years %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="{{ url_for('year_view', year_id=y.id) }}">{{ y.name }} ({{y.year}})</a>
                    <span>
                        {% if y.fixture_path %}
                            <small class="text-success">Spielplan vorhanden</small>
                        {% else %}
                            <small class="text-warning">Kein Spielplan</small>
                        {% endif %}
                    </span>
                    <form method="POST" style="display: inline;" onsubmit="return confirm('Sind Sie sicher, dass Sie das Turnier \'{{ y.name }} ({{ y.year }})\' und alle zugehörigen Daten löschen möchten?');">
                        <input type="hidden" name="year_id_to_delete" value="{{ y.id }}">
                        <button type="submit" name="delete_year" class="btn btn-danger btn-sm">Löschen</button>
                    </form>
                </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Noch keine Turniere angelegt.</p>
        {% endif %}
    </div>
</div>
{% endblock %} 